<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artomatique WAX - Maquette Technique PoC</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- FontAwesome for Icons (No SVG) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        wax: {
                            50: '#fffbf0',
                            100: '#ffefc2',
                            500: '#f59e0b', // Amber-500 equivalent
                            600: '#d97706',
                            900: '#78350f',
                        },
                        stone: {
                            50: '#fafaf9',
                            800: '#292524',
                            900: '#1c1917',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #fafaf9; /* stone-50 */
            color: #292524; /* stone-800 */
        }
        
        /* Chart Container Styling Rules */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px; 
            height: 300px;
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar for inner content */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #d6d3d1; 
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #a8a29e; 
        }

        .step-card.active {
            border-left: 4px solid #f59e0b;
            background-color: #fffbf0;
        }
        
        .step-card {
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeInUp {
            animation: fadeInUp 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="font-sans antialiased selection:bg-wax-100 selection:text-wax-900">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-stone-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-wax-500 rounded-lg flex items-center justify-center text-white font-bold shadow-sm">
                        <i class="fa-solid fa-robot"></i>
                    </div>
                    <span class="font-bold text-xl tracking-tight text-stone-900">Artomatique<span class="text-wax-600">WAX</span></span>
                </div>
                <div class="hidden md:flex space-x-8 text-sm font-medium text-stone-600">
                    <a href="#stack" class="hover:text-wax-600 transition-colors">Stack Technique</a>
                    <a href="#rarity" class="hover:text-wax-600 transition-colors">Logique Rareté</a>
                    <a href="#pro-options" class="hover:text-wax-600 transition-colors">Options Pro</a>
                    <a href="#simulation" class="px-4 py-2 bg-stone-900 text-white rounded-lg hover:bg-stone-800 transition-colors shadow-sm">Lancer PoC</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="relative bg-stone-50 overflow-hidden">
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-20"></div>
        <div class="relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center">
            <div class="inline-block px-4 py-1.5 mb-6 text-xs font-semibold tracking-wider text-wax-900 uppercase bg-wax-100 rounded-full">
                Preuve de Concept (PoC)
            </div>
            <h1 class="text-4xl md:text-5xl font-extrabold text-stone-900 mb-6 leading-tight">
                Production Automatisée de Packs NFT <br>sur <span class="text-wax-600">WAX Testnet</span>
            </h1>
            <p class="text-xl text-stone-600 mb-10 max-w-2xl mx-auto leading-relaxed">
                Une démonstration technique de l'orchestration complète : de la génération par prompt à la distribution de packs de 5 cartes, utilisant uniquement des outils gratuits.
            </p>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button onclick="scrollToSection('workflow')" class="px-8 py-3.5 bg-white border border-stone-300 text-stone-700 font-semibold rounded-xl hover:bg-stone-50 transition-all shadow-sm flex items-center justify-center gap-2 group">
                    <span>Explorer le Workflow</span>
                    <i class="fa-solid fa-arrow-down group-hover:translate-y-1 transition-transform"></i>
                </button>
                <button onclick="scrollToSection('simulation')" class="px-8 py-3.5 bg-wax-500 text-white font-semibold rounded-xl hover:bg-wax-600 transition-all shadow-lg hover:shadow-wax-500/30 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-play"></i>
                    <span>Simuler le Minting</span>
                </button>
            </div>
        </div>
    </section>

    <!-- Section WAX Wallet Widget (Updated to 2 columns) -->
    <section class="py-12 bg-wax-50 border-b border-wax-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 1. Acheter WAX -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-wax-200">
                    <h3 class="text-xl font-bold text-stone-900 mb-3 flex items-center gap-2"><i class="fa-solid fa-cart-shopping text-wax-600"></i> Acheter WAX</h3>
                    <p class="text-sm text-stone-600 mb-4">Besoin de WAX pour les options Premium ? Achetez-en facilement via notre partenaire d'échange.</p>
                    <button class="w-full px-4 py-2 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition-colors text-sm">
                        <i class="fa-solid fa-arrow-up-right-from-square mr-2"></i> Acheter WAX Maintenant
                    </button>
                </div>
                <!-- 2. Vendre WAX -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-wax-200">
                    <h3 class="text-xl font-bold text-stone-900 mb-3 flex items-center gap-2"><i class="fa-solid fa-exchange-alt text-wax-600"></i> Vendre / Échanger</h3>
                    <p class="text-sm text-stone-600 mb-4">Convertissez vos gains en WAX en monnaie fiduciaire ou autres crypto-monnaies.</p>
                    <button class="w-full px-4 py-2 bg-stone-500 text-white font-semibold rounded-lg hover:bg-stone-600 transition-colors text-sm">
                        <i class="fa-solid fa-wallet mr-2"></i> Se Connecter au Portefeuille
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 1: Stack Technique (Services Gratuits) -->
    <section id="stack" class="py-16 bg-white border-b border-stone-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-stone-900 mb-4">Architecture & Outils Gratuits</h2>
                <p class="text-stone-600 max-w-3xl">
                    Ce PoC repose sur une sélection rigoureuse d'outils permettant de valider le concept sans coûts d'infrastructure initiaux. Chaque outil joue un rôle critique dans le pipeline automatisé.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Tool Cards (unchanged for brevity) -->
                <div class="p-6 bg-stone-50 rounded-2xl border border-stone-100 hover:border-wax-500/50 hover:shadow-md transition-all group">
                    <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                        <i class="fa-solid fa-network-wired text-xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-stone-900 mb-2">n8n (Cœur)</h3>
                    <p class="text-sm text-stone-500 mb-3">Orchestrateur du flux</p>
                    <p class="text-sm text-stone-600 leading-relaxed">
                        Gère les déclencheurs Webhook, la logique conditionnelle et les boucles de production des cartes.
                    </p>
                </div>
                <div class="p-6 bg-stone-50 rounded-2xl border border-stone-100 hover:border-wax-500/50 hover:shadow-md transition-all group">
                    <div class="w-12 h-12 bg-purple-100 text-purple-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                        <i class="fa-solid fa-wand-magic-sparkles text-xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-stone-900 mb-2">Mock Data (IA)</h3>
                    <p class="text-sm text-stone-500 mb-3">Simulation Générative</p>
                    <p class="text-sm text-stone-600 leading-relaxed">
                        Simule les réponses d'API IA coûteuses (DALL-E) pour valider la logique sans frais.
                    </p>
                </div>
                <div class="p-6 bg-stone-50 rounded-2xl border border-stone-100 hover:border-wax-500/50 hover:shadow-md transition-all group">
                    <div class="w-12 h-12 bg-orange-100 text-orange-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                        <i class="fa-solid fa-cube text-xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-stone-900 mb-2">Pinata (IPFS)</h3>
                    <p class="text-sm text-stone-500 mb-3">Stockage Décentralisé</p>
                    <p class="text-sm text-stone-600 leading-relaxed">
                        Hébergement gratuit des assets visuels (images des cartes) pour obtenir les Hash IPFS.
                    </p>
                </div>
                <div class="p-6 bg-stone-50 rounded-2xl border border-stone-100 hover:border-wax-500/50 hover:shadow-md transition-all group">
                    <div class="w-12 h-12 bg-yellow-100 text-yellow-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                        <i class="fa-solid fa-coins text-xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-stone-900 mb-2">WAX Testnet</h3>
                    <p class="text-sm text-stone-500 mb-3">Blockchain & AtomicAssets</p>
                    <p class="text-sm text-stone-600 leading-relaxed">
                        Environnement de minting sans frais de gaz réels, idéal pour les tests de smart contracts.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section: Options PRO and WAX Pricing -->
    <section id="pro-options" class="py-16 bg-stone-50 border-y border-stone-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
                
                <!-- Left: Pro Options Selector -->
                <div class="bg-white p-8 rounded-2xl shadow-lg border border-stone-200">
                    <h2 class="text-2xl font-bold text-stone-900 mb-2 flex items-center gap-2"><i class="fa-solid fa-star text-wax-600"></i> Options Artomatique Pro</h2>
                    <p class="text-stone-600 mb-6">
                        Améliorez vos cartes avec des modificateurs de prompt pour une qualité et un style supérieurs. Chaque option augmente le coût de minage en WAX.
                    </p>

                    <div id="options-container" class="space-y-4">
                        <!-- Options injected by JS -->
                    </div>
                </div>

                <!-- Right: Pricing and Checkout -->
                <div class="bg-white p-8 rounded-2xl shadow-lg border border-stone-200 sticky top-20">
                    <h3 class="text-2xl font-bold text-stone-900 mb-6 flex items-center gap-2"><i class="fa-solid fa-money-bill-wave text-wax-600"></i> Récapitulatif WAX</h3>

                    <div class="space-y-4 border-b pb-4 mb-4">
                        <div class="flex justify-between items-center text-stone-700">
                            <span>Pack Standard (5 Cartes)</span>
                            <span class="font-bold text-stone-900">20 WAX</span>
                        </div>
                        <div class="flex justify-between items-center text-stone-700">
                            <span>Coût de Base IA / Minting</span>
                            <span class="font-bold text-red-500">-7 WAX</span>
                        </div>
                        <div class="flex justify-between items-center text-stone-700 border-t pt-2 mt-2">
                            <span>**Marge Brute (Profit)**</span>
                            <span id="base-profit" class="font-bold text-green-600">13 WAX</span>
                        </div>
                    </div>

                    <div id="cost-details" class="space-y-3 mb-6">
                        <div class="flex justify-between items-center text-stone-700">
                            <span>Options Artistiques Suppl.</span>
                            <span id="extra-cost" class="font-bold text-wax-600">+ 0 WAX</span>
                        </div>
                        <!-- Affiliation section removed -->
                    </div>

                    <div class="flex justify-between items-center bg-wax-100 p-4 rounded-xl border border-wax-200">
                        <span class="text-xl font-bold text-stone-900">COÛT TOTAL DU PACK</span>
                        <span id="total-wax-cost" class="text-3xl font-extrabold text-wax-600">
                            20 WAX
                        </span>
                    </div>

                    <button class="w-full mt-6 px-6 py-3 bg-wax-500 text-white font-bold rounded-xl hover:bg-wax-600 transition-colors shadow-lg flex items-center justify-center gap-2">
                        <i class="fa-solid fa-shield-halved"></i> Procéder au Minting (Simulé)
                    </button>
                    <p class="text-center text-xs text-stone-500 mt-3">Transaction en WAX Testnet. Pas de frais réels.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Rarity Logic Dashboard -->
    <section id="rarity" class="py-16 bg-white">
        <!-- Content remains the same -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
                <div class="lg:col-span-1">
                    <div class="inline-block px-3 py-1 mb-4 text-xs font-semibold text-wax-600 bg-wax-100 rounded-md">Gamification</div>
                    <h2 class="text-3xl font-bold text-stone-900 mb-6">Logique de Rareté & Taux de Drop</h2>
                    <p class="text-stone-600 mb-6 leading-relaxed">
                        L'automatisation ne se contente pas de créer des images ; elle applique une logique algorithmique pour attribuer une valeur à chaque carte du pack. Cette logique est exécutée via un <strong>nœud Function JavaScript</strong> dans n8n.
                    </p>
                    <ul class="space-y-4 mb-8">
                        <li class="flex items-start">
                            <span class="w-6 h-6 bg-yellow-400 rounded-full flex items-center justify-center text-white text-xs mr-3 mt-1 shadow-sm"><i class="fa-solid fa-crown"></i></span>
                            <div>
                                <strong class="text-stone-900">Légendaire (1%)</strong>
                                <p class="text-sm text-stone-500">Extrêmement rare, génère une excitation maximale.</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="w-6 h-6 bg-blue-400 rounded-full flex items-center justify-center text-white text-xs mr-3 mt-1 shadow-sm"><i class="fa-solid fa-gem"></i></span>
                            <div>
                                <strong class="text-stone-900">Rare (10%)</strong>
                                <p class="text-sm text-stone-500">Un bon tirage, souvent garanti dans les packs premium.</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="w-6 h-6 bg-stone-400 rounded-full flex items-center justify-center text-white text-xs mr-3 mt-1 shadow-sm"><i class="fa-solid fa-circle"></i></span>
                            <div>
                                <strong class="text-stone-900">Commun (89%)</strong>
                                <p class="text-sm text-stone-500">La base de la collection.</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="lg:col-span-2 bg-stone-50 p-8 rounded-2xl shadow-sm border border-stone-200">
                    <div class="flex flex-col md:flex-row items-center justify-between mb-6">
                        <h3 class="font-bold text-stone-800">Distribution Probabiliste</h3>
                        <div class="text-sm text-stone-500">Modèle Pack 5 Cartes</div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="rarityChart"></canvas>
                    </div>

                    <div class="mt-8 p-4 bg-white rounded-xl border border-stone-100 text-center">
                        <p class="text-sm text-stone-600">
                            <i class="fa-solid fa-calculator mr-2 text-wax-600"></i>
                            Calcul dynamique effectué par le code JavaScript du nœud n8n pour chaque carte générée.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3: Workflow Engine -->
    <section id="workflow" class="py-16 bg-white border-y border-stone-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="mb-12 text-center">
                <h2 class="text-3xl font-bold text-stone-900">Le Workflow n8n Détaillé</h2>
                <p class="text-stone-500 mt-2">Cliquez sur les étapes pour visualiser le flux de données.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Left: Steps List (unchanged for brevity) -->
                <div class="lg:col-span-5 space-y-3">
                    <div onclick="setStep(1)" id="step-btn-1" class="step-card active cursor-pointer p-4 rounded-lg hover:bg-stone-50 flex items-center gap-4 group">
                        <div class="w-10 h-10 rounded-full bg-stone-200 text-stone-600 font-bold flex items-center justify-center group-hover:bg-wax-100 group-hover:text-wax-600 transition-colors">1</div>
                        <div>
                            <h4 class="font-bold text-stone-900">Trigger (Webhook)</h4>
                            <p class="text-xs text-stone-500">Réception du Prompt & Options Payantes</p>
                        </div>
                    </div>
                    <div onclick="setStep(2)" id="step-btn-2" class="step-card cursor-pointer p-4 rounded-lg hover:bg-stone-50 flex items-center gap-4 group">
                        <div class="w-10 h-10 rounded-full bg-stone-200 text-stone-600 font-bold flex items-center justify-center group-hover:bg-wax-100 group-hover:text-wax-600 transition-colors">2</div>
                        <div>
                            <h4 class="font-bold text-stone-900">Logique Pack & Rareté</h4>
                            <p class="text-xs text-stone-500">Calcul JS des 5 cartes</p>
                        </div>
                    </div>
                    <div onclick="setStep(3)" id="step-btn-3" class="step-card cursor-pointer p-4 rounded-lg hover:bg-stone-50 flex items-center gap-4 group">
                        <div class="w-10 h-10 rounded-full bg-stone-200 text-stone-600 font-bold flex items-center justify-center group-hover:bg-wax-100 group-hover:text-wax-600 transition-colors">3</div>
                        <div>
                            <h4 class="font-bold text-stone-900">Mock Image Pack</h4>
                            <p class="text-xs text-stone-500">Simulation IA & Hash IPFS</p>
                        </div>
                    </div>
                    <div onclick="setStep(4)" id="step-btn-4" class="step-card cursor-pointer p-4 rounded-lg hover:bg-stone-50 flex items-center gap-4 group">
                        <div class="w-10 h-10 rounded-full bg-stone-200 text-stone-600 font-bold flex items-center justify-center group-hover:bg-wax-100 group-hover:text-wax-600 transition-colors">4</div>
                        <div>
                            <h4 class="font-bold text-stone-900">Mint Pack NFT</h4>
                            <p class="text-xs text-stone-500">Appel AtomicAssets (WAX)</p>
                        </div>
                    </div>
                    <div onclick="setStep(5)" id="step-btn-5" class="step-card cursor-pointer p-4 rounded-lg hover:bg-stone-50 flex items-center gap-4 group">
                        <div class="w-10 h-10 rounded-full bg-stone-200 text-stone-600 font-bold flex items-center justify-center group-hover:bg-wax-100 group-hover:text-wax-600 transition-colors">5</div>
                        <div>
                            <h4 class="font-bold text-stone-900">Boucle Mint Cartes (x5)</h4>
                            <p class="text-xs text-stone-500">Split Batches -> Mint Individuel</p>
                        </div>
                    </div>
                    <div onclick="setStep(6)" id="step-btn-6" class="step-card cursor-pointer p-4 rounded-lg hover:bg-stone-50 flex items-center gap-4 group">
                        <div class="w-10 h-10 rounded-full bg-stone-200 text-stone-600 font-bold flex items-center justify-center group-hover:bg-wax-100 group-hover:text-wax-600 transition-colors">6</div>
                        <div>
                            <h4 class="font-bold text-stone-900">Distribution Finale</h4>
                            <p class="text-xs text-stone-500">Transfert au portefeuille utilisateur</p>
                        </div>
                    </div>
                </div>

                <!-- Right: Data Visualizer (unchanged for brevity) -->
                <div class="lg:col-span-7">
                    <div class="bg-stone-900 rounded-xl shadow-2xl overflow-hidden h-full flex flex-col">
                        <div class="bg-stone-800 px-4 py-3 flex items-center justify-between border-b border-stone-700">
                            <span class="text-stone-300 text-sm font-mono"><i class="fa-solid fa-code mr-2"></i>Payload Data Viewer</span>
                            <span id="step-badge" class="px-2 py-0.5 rounded text-xs font-bold bg-wax-500 text-white">Étape 1</span>
                        </div>
                        <div class="p-6 overflow-y-auto custom-scroll flex-grow font-mono text-sm">
                            <div id="data-display" class="space-y-2">
                                <!-- Dynamic Content Injected via JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 4: Live Simulation -->
    <section id="simulation" class="py-20 bg-stone-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <div class="inline-block px-3 py-1 mb-4 text-xs font-semibold text-green-600 bg-green-100 rounded-md">Démo Interactive</div>
                <h2 class="text-3xl font-bold text-stone-900">Simulateur de Production n8n</h2>
                <p class="text-stone-600 mt-4 max-w-2xl mx-auto">
                    Testez la logique du PoC en temps réel. Le prompt IA est généré en fonction des options payantes sélectionnées ci-dessus.
                </p>
            </div>

            <div class="bg-white rounded-2xl shadow-lg border border-stone-200 overflow-hidden">
                <!-- Control Panel -->
                <div class="p-8 border-b border-stone-100 flex flex-col sm:flex-row items-center justify-between gap-6 bg-stone-50/50">
                    <div class="flex-1 w-full sm:w-auto">
                        <label class="block text-xs font-bold text-stone-500 uppercase mb-2">Prompt Utilisateur</label>
                        <input type="text" id="user-prompt" value="Cyberpunk Samurai Cat" class="w-full bg-white border border-stone-300 rounded-lg px-4 py-2 text-stone-700 focus:outline-none focus:ring-2 focus:ring-wax-500">
                    </div>
                    <button onclick="runSimulation()" id="sim-btn" class="w-full sm:w-auto px-8 py-3 bg-wax-600 hover:bg-wax-500 text-white font-bold rounded-xl shadow-lg shadow-wax-500/20 transition-all transform active:scale-95 flex items-center justify-center gap-2">
                        <i class="fa-solid fa-bolt"></i>
                        <span>Mint avec <span id="btn-wax-cost">20</span> WAX</span>
                    </button>
                </div>

                <!-- Results Area -->
                <div class="p-8 bg-stone-100/50 min-h-[300px]">
                    <div id="loading-indicator" class="hidden flex flex-col items-center justify-center h-48">
                        <div class="w-12 h-12 border-4 border-wax-200 border-t-wax-600 rounded-full animate-spin mb-4"></div>
                        <p class="text-stone-500 animate-pulse">Orchestration n8n en cours...</p>
                        <p id="final-prompt" class="text-xs mt-2 text-stone-400 font-mono"></p>
                    </div>

                    <div id="results-grid" class="hidden grid grid-cols-2 md:grid-cols-5 gap-4">
                        <!-- Cards injected here -->
                    </div>

                    <div id="empty-state" class="flex flex-col items-center justify-center h-48 text-stone-400">
                        <i class="fa-solid fa-box-open text-4xl mb-3 opacity-50"></i>
                        <p>En attente du déclencheur webhook...</p>
                    </div>
                </div>

                <!-- Simulation Stats -->
                <div class="p-6 bg-white border-t border-stone-200 flex justify-between items-center text-sm">
                    <span class="text-stone-500"><i class="fa-solid fa-database mr-2"></i>Status WAX Testnet: <span class="text-green-600 font-semibold">Connecté (Simulé)</span></span>
                    <span class="text-stone-500">Marge Profit (simulée): <span id="sim-profit" class="text-stone-900 font-bold">13 WAX</span></span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-stone-900 text-stone-400 py-12 border-t border-stone-800">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="mb-4 text-stone-100 font-semibold">Artomatique WAX PoC</p>
            <p class="text-sm">Maquette Technique pour l'automatisation n8n et le modèle économique WAX.</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- State Management ---
        const BASE_PACK_COST = 20; // WAX (Prix de vente du pack)
        const BASE_IA_COST = 7;    // WAX (Coût estimé IA/Minting)
        
        const state = {
            currentStep: 1,
            rarityRates: { legendary: 0.01, rare: 0.11, common: 1.0 }, 
            selectedOptions: {}, // Store {id: {cost: N, modifier: 'string'}}
        };

        const artOptions = [
            { id: 'style-photo', name: 'Photoréalisme 8K', cost: 5, modifier: 'hyper-detailed, 8K, cinematic lighting', category: 'Style' },
            { id: 'style-oil', name: 'Peinture à l\'Huile', cost: 3, modifier: 'masterpiece oil painting on canvas', category: 'Style' },
            { id: 'light-volumetric', name: 'Éclairage Volumétrique', cost: 4, modifier: 'god rays, volumetric light', category: 'Lumière' },
            { id: 'light-neon', name: 'Couleurs Néo-Tokyo', cost: 3, modifier: 'neon glow, vaporwave aesthetic', category: 'Lumière' },
            { id: 'comp-dof', name: 'Mise au Point Cinématographique', cost: 2, modifier: 'shallow depth of field, 85mm lens', category: 'Composition' },
            { id: 'comp-plongee', name: 'Angle Plongée Épique', cost: 2, modifier: 'epic high-angle shot, looking up', category: 'Composition' }
        ];

        // --- Data Content for Workflow Steps (JSON formatted strings) ---
        const stepData = {
            1: `<span class="text-green-400">// WEBHOOK POST RECEIVED</span>
{
  "body": {
    "theme_prompt": "Alien Jungle Cyberpunk",
    "target_wax_account": "user1.test",
    "pack_qty": 1,
    "selected_mods": [
        "hyper-detailed, 8K, cinematic lighting", 
        "god rays, volumetric light"
    ],
    "total_wax_paid": 29
  },
  "timestamp": "${new Date().toISOString()}"
}`,
            2: `<span class="text-blue-400">// FUNCTION: GENERATE RARITY & FINAL PROMPT</span>
// Base Prompt: "Alien Jungle Cyberpunk"
// Final Prompt: "Alien Jungle Cyberpunk, hyper-detailed, 8K, cinematic lighting, god rays, volumetric light"
[
  {
    "card_id": 1,
    "rarity": "Common",
    "prompt_mod": "Standard Alien Plant..."
  },
  ...
]`,
            3: `...`, 4: `...`, 5: `...`, 6: `...` // Simplified for the update
        };

        // --- Init Functions ---
        document.addEventListener('DOMContentLoaded', () => {
            renderChart();
            renderOptions();
            updateTotalCost();
            setStep(1);
            document.getElementById('base-profit').textContent = `${BASE_PACK_COST - BASE_IA_COST} WAX`;
        });

        // --- Core Functions ---

        function renderOptions() {
            const container = document.getElementById('options-container');
            let html = '';
            
            // Group options by category
            const groupedOptions = artOptions.reduce((acc, option) => {
                acc[option.category] = acc[option.category] || [];
                acc[option.category].push(option);
                return acc;
            }, {});

            for (const category in groupedOptions) {
                html += `<div class="p-4 bg-stone-50 rounded-lg">
                    <h4 class="font-bold text-stone-800 border-b pb-2 mb-3 text-sm">${category.toUpperCase()}</h4>
                    <div class="space-y-2">`;
                
                groupedOptions[category].forEach(option => {
                    html += `
                        <label for="${option.id}" class="flex items-center justify-between cursor-pointer group">
                            <div class="flex items-center">
                                <input type="checkbox" id="${option.id}" data-cost="${option.cost}" data-modifier="${option.modifier}"
                                    onchange="handleOptionChange(this)"
                                    class="h-4 w-4 text-wax-600 border-stone-300 rounded focus:ring-wax-500">
                                <span class="ml-3 text-sm font-medium text-stone-700">${option.name}</span>
                            </div>
                            <span class="text-xs font-semibold text-wax-700 bg-wax-100 px-2 py-0.5 rounded-full">+${option.cost} WAX</span>
                        </label>`;
                });
                
                html += `</div></div>`;
            }

            container.innerHTML = html;
        }

        function handleOptionChange(checkbox) {
            const id = checkbox.id;
            const cost = parseInt(checkbox.dataset.cost);
            const modifier = checkbox.dataset.modifier;

            if (checkbox.checked) {
                state.selectedOptions[id] = { cost, modifier };
            } else {
                delete state.selectedOptions[id];
            }

            updateTotalCost();
        }

        function updateTotalCost() {
            let extraCost = 0;
            let modifiers = [];

            for (const id in state.selectedOptions) {
                extraCost += state.selectedOptions[id].cost;
                modifiers.push(state.selectedOptions[id].modifier);
            }

            const totalCost = BASE_PACK_COST + extraCost;
            // Marge brute = (Prix de vente + Coûts Supplémentaires) - Coût IA de base
            const profit = totalCost - BASE_IA_COST; 

            document.getElementById('extra-cost').textContent = `+ ${extraCost} WAX`;
            document.getElementById('total-wax-cost').textContent = `${totalCost} WAX`;
            document.getElementById('btn-wax-cost').textContent = totalCost;
            document.getElementById('sim-profit').textContent = `${profit.toFixed(1)} WAX`;
            
            // Update step 1 data with current cost
            const currentStep1Data = stepData[1];
            stepData[1] = currentStep1Data.replace(
                /"total_wax_paid": \d+/, 
                `"total_wax_paid": ${totalCost}`
            );
            
            // Update step 2 data with modifiers
            const basePrompt = document.getElementById('user-prompt').value;
            const finalPrompt = basePrompt + (modifiers.length > 0 ? `, ${modifiers.join(', ')}` : '');
            
            stepData[2] = stepData[2].replace(
                /Final Prompt: ".*"/, 
                `Final Prompt: "${finalPrompt}"`
            ).replace(
                /selected_mods": \[.*?\],/s,
                `selected_mods": [\n        "${modifiers.join('", \n        "')}"\n    ],`
            );
            
            // Re-render current step if active
            if (state.currentStep === 1 || state.currentStep === 2) {
                setStep(state.currentStep, false); // Update without animation
            }
        }

        function setStep(step, animate = true) {
            // Update UI State
            document.querySelectorAll('.step-card').forEach(el => el.classList.remove('active'));
            document.getElementById(`step-btn-${step}`).classList.add('active');
            state.currentStep = step;
            
            // Update Data Display
            const display = document.getElementById('data-display');
            display.innerHTML = stepData[step];
            if (animate) {
                display.classList.add('animate-pulse');
                setTimeout(() => display.classList.remove('animate-pulse'), 300);
            }

            // Update Badge
            const badge = document.getElementById('step-badge');
            badge.innerText = `Étape ${step}`;
            
            const colors = ['bg-stone-500', 'bg-blue-500', 'bg-purple-500', 'bg-yellow-500', 'bg-orange-500', 'bg-green-500'];
            badge.className = `px-2 py-0.5 rounded text-xs font-bold text-white ${colors[step-1]}`;
        }
        
        function renderChart() {
            const ctx = document.getElementById('rarityChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Commun (89%)', 'Rare (10%)', 'Légendaire (1%)'],
                    datasets: [{
                        data: [89, 10, 1],
                        backgroundColor: [
                            '#a8a29e', // stone-400
                            '#60a5fa', // blue-400
                            '#facc15'  // yellow-400
                        ],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                font: { family: 'Inter', size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ` ${context.label}`;
                                }
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }

        function runSimulation() {
            const btn = document.getElementById('sim-btn');
            const loader = document.getElementById('loading-indicator');
            const results = document.getElementById('results-grid');
            const empty = document.getElementById('empty-state');
            
            // Get final prompt for display
            const modifiers = Object.values(state.selectedOptions).map(opt => opt.modifier);
            const finalPrompt = document.getElementById('user-prompt').value + (modifiers.length > 0 ? `, ${modifiers.join(', ')}` : '');
            
            // Reset UI
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');
            empty.classList.add('hidden');
            results.classList.add('hidden');
            loader.classList.remove('hidden');
            document.getElementById('final-prompt').textContent = `Prompt IA généré: "${finalPrompt}"`;

            // Simulate Network Delay (1.5s)
            setTimeout(() => {
                const pulledCards = [];
                // Generate 5 cards based on rarity logic
                for (let i = 0; i < 5; i++) {
                    const rand = Math.random();
                    let type = 'Commun';
                    let color = 'bg-stone-200 text-stone-600 border-stone-300';
                    let icon = 'fa-circle';

                    if (rand < 0.01) {
                        type = 'Légendaire';
                        color = 'bg-yellow-100 text-yellow-700 border-yellow-400';
                        icon = 'fa-crown';
                    } else if (rand < 0.11) {
                        type = 'Rare';
                        color = 'bg-blue-100 text-blue-700 border-blue-400';
                        icon = 'fa-gem';
                    }

                    pulledCards.push({ type, color, icon, id: 1000 + Math.floor(Math.random() * 9000) });
                }

                // Render Results
                results.innerHTML = '';
                pulledCards.forEach((card, index) => {
                    const html = `
                        <div class="animate-fadeInUp" style="animation-delay: ${index * 100}ms">
                            <div class="h-40 rounded-xl border-2 ${card.color} flex flex-col items-center justify-center p-2 relative overflow-hidden shadow-sm transition-transform hover:scale-105">
                                <i class="fa-solid ${card.icon} text-3xl mb-2"></i>
                                <span class="font-bold text-sm">${card.type}</span>
                                <span class="text-xs opacity-75">#${card.id}</span>
                                <div class="absolute bottom-0 left-0 w-full h-1 bg-current opacity-20"></div>
                            </div>
                        </div>
                    `;
                    results.insertAdjacentHTML('beforeend', html);
                });

                loader.classList.add('hidden');
                results.classList.remove('hidden');
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                
            }, 1500);
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
